<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
		<head>
			<!-- template designed by Marco Von Ballmoos  -->
			<title>Docs for page PgQuery.php</title>
			<link rel="stylesheet" href="../../media/stylesheet.css" />
						<script src="../../media/lib/classTree.js"></script>
												<script language="javascript" type="text/javascript">
				var imgPlus = new Image();
				var imgMinus = new Image();
				imgPlus.src = "../../media/images/plus.png";
				imgMinus.src = "../../media/images/minus.png";
				
				function showNode(Node){
							switch(navigator.family){
								case 'nn4':
									// Nav 4.x code fork...
							var oTable = document.layers["span" + Node];
							var oImg = document.layers["img" + Node];
									break;
								case 'ie4':
									// IE 4/5 code fork...
							var oTable = document.all["span" + Node];
							var oImg = document.all["img" + Node];
									break;
								case 'gecko':
									// Standards Compliant code fork...
							var oTable = document.getElementById("span" + Node);
							var oImg = document.getElementById("img" + Node);
									break;
							}
					oImg.src = imgMinus.src;
					oTable.style.display = "block";
				}
				
				function hideNode(Node){
							switch(navigator.family){
								case 'nn4':
									// Nav 4.x code fork...
							var oTable = document.layers["span" + Node];
							var oImg = document.layers["img" + Node];
									break;
								case 'ie4':
									// IE 4/5 code fork...
							var oTable = document.all["span" + Node];
							var oImg = document.all["img" + Node];
									break;
								case 'gecko':
									// Standards Compliant code fork...
							var oTable = document.getElementById("span" + Node);
							var oImg = document.getElementById("img" + Node);
									break;
							}
					oImg.src = imgPlus.src;
					oTable.style.display = "none";
				}
				
				function nodeIsVisible(Node){
							switch(navigator.family){
								case 'nn4':
									// Nav 4.x code fork...
							var oTable = document.layers["span" + Node];
									break;
								case 'ie4':
									// IE 4/5 code fork...
							var oTable = document.all["span" + Node];
									break;
								case 'gecko':
									// Standards Compliant code fork...
							var oTable = document.getElementById("span" + Node);
									break;
							}
					return (oTable && oTable.style.display == "block");
				}
				
				function toggleNodeVisibility(Node){
					if (nodeIsVisible(Node)){
						hideNode(Node);
					}else{
						showNode(Node);
					}
				}
			</script>
					</head>
		<body>
			<div class="page-body">			
<h2 class="file-name"><img src="../../media/images/Page_logo.png" alt="File" style="vertical-align: middle">/PgQuery.php</h2>

<a name="sec-description"></a>
<div class="info-box">
	<div class="info-box-title">Description</div>
	<div class="nav-bar">
					<span class="disabled">Description</span> |
							<a href="#sec-classes">Classes</a>
			|							<a href="#sec-includes">Includes</a>
			|									<a href="#sec-variables">Variables</a>
			|							<a href="#sec-functions">Functions</a>
			</div>
	<div class="info-box-body">	
		<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">PostgreSQL query class and associated functions</p>
<p class="description"><p>This subpackage provides some functions that are useful around database  activity and a PgQuery class to simplify handling of database queries.</p><p>The class is intended to be a very lightweight wrapper with no pretentions  towards database independence, but it does include some features that have  proved useful in developing and debugging web-based applications: <ul><li>All queries are timed, and an expected time can be provided.</li><li>Parameters replaced into the SQL will be escaped correctly in order to
    minimise the chances of SQL injection errors.</li><li>Queries which fail, or which exceed their expected execution time, will
    be logged for potential further analysis.</li><li>Debug logging of queries may be enabled globally, or restricted to
    particular sets of queries.</li><li>Simple syntax for iterating through a result set.</li></ul>  The database should be connected in a variable $dbconn before  PgQuery.php is included.  If not already connected, PgQuery will attempt to  connect to the database, successively applying connection parameters from  the array in $c-&gt;pg_connect.</p><p>We will die if the database is not currently connected and we fail to find  a working connection.</p></p>
	<ul class="tags">
				<li><span class="field">author:</span> Andrew McMillan &lt;<a href="mailto:andrew@mcmillan.net.nz">andrew@mcmillan.net.nz</a>&gt;</li>
				<li><span class="field">copyright:</span> Catalyst IT Ltd, Morphoss Ltd &lt;http://www.morphoss.com/&gt;</li>
				<li><span class="field">license:</span> <a href="http://gnu.org/copyleft/gpl.html">GNU GPL v2 or later</a></li>
			</ul>
		
			</div>
</div>
		
	<a name="sec-classes"></a>	
	<div class="info-box">
		<div class="info-box-title">Classes</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
			<span class="disabled">Classes</span>
			|							<a href="#sec-includes">Includes</a>
				|													<a href="#sec-variables">Variables</a>
				|										<a href="#sec-functions">Functions</a>
					</div>
		<div class="info-box-body">	
			<table cellpadding="2" cellspacing="0" class="class-table">
				<tr>
					<th class="class-table-header">Class</th>
					<th class="class-table-header">Description</th>
				</tr>
								<tr>
					<td style="padding-right: 2em; vertical-align: top; white-space: nowrap">
						<img src="../../media/images/Class.png"
								 alt=" class"
								 title=" class"/>
						<a href="../../awl/PgQuery/PgQuery.html">PgQuery</a>
					</td>
					<td>
											The PgQuery Class.
										</td>
				</tr>
							</table>
		</div>
	</div>

	<a name="sec-includes"></a>	
	<div class="info-box">
		<div class="info-box-title">Includes</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
							<a href="#sec-classes">Classes</a>
				|						<span class="disabled">Includes</span>
			|										<a href="#sec-variables">Variables</a>
				|										<a href="#sec-functions">Functions</a>
					</div>
		<div class="info-box-body">	
			<a name="_AWLUtilities_php"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../../media/images/Page.png" alt=" " />
		<span class="include-title">
			<span class="include-type">require_once</span>
			(<span class="include-name"><a href="../../awl/Utilities/_AWLUtilities.php.html">"AWLUtilities.php"</a></span>)
			(line <span class="line-number">56</span>)
		</span>
	</div>

	<!-- ========== Info from phpDoc block ========= -->
	
</div>
		</div>
	</div>
	
	
	<a name="sec-variables"></a>	
	<div class="info-box">
		<div class="info-box-title">Variables</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
							<a href="#sec-classes">Classes</a>
				|										<a href="#sec-includes">Includes</a>
				|									<span class="disabled">Variables</span>
			|							<a href="#sec-functions">Functions</a>
					</div>
		<div class="info-box-body">	
			
Strict Standards: Only variables should be passed by reference in /usr/share/php/PhpDocumentor/phpDocumentor/Smarty-2.6.0/libs/Smarty_Compiler.class.php on line 712

Warning: strftime(): It is not safe to rely on the system's timezone settings. You are *required* to use the date.timezone setting or the date_default_timezone_set() function. In case you used any of those methods and you are still getting this warning, you most likely misspelled the timezone identifier. We selected the timezone 'UTC' for now, but please set date.timezone to select your timezone. in /usr/share/php/PhpDocumentor/phpDocumentor/Smarty-2.6.0/libs/Smarty_Compiler.class.php on line 370
<a name="global$dbconn
 The database connection." id="global$dbconn
 The database connection."><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../../media/images/Global.png" />
		<span class="var-title">
			<span class="var-type">resource</span>
			<span class="var-name">$dbconn
 The database connection.</span>
						(line <span class="line-number">107</span>)
		</span>
	</div>

	<!-- ========== Info from phpDoc block ========= -->
	<ul class="tags">
				<li><span class="field">name:</span> $dbconn
 The database connection.</li>
			</ul>
	
		
</div>
		</div>
	</div>
	
	<a name="sec-functions"></a>	
	<div class="info-box">
		<div class="info-box-title">Functions</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
							<a href="#sec-classes">Classes</a>
				|										<a href="#sec-includes">Includes</a>
				|													<a href="#sec-variables">Variables</a>
				|						<span class="disabled">Functions</span>
		</div>
		<div class="info-box-body">	
			
Strict Standards: Only variables should be passed by reference in /usr/share/php/PhpDocumentor/phpDocumentor/Smarty-2.6.0/libs/Smarty_Compiler.class.php on line 712

Warning: strftime(): It is not safe to rely on the system's timezone settings. You are *required* to use the date.timezone setting or the date_default_timezone_set() function. In case you used any of those methods and you are still getting this warning, you most likely misspelled the timezone identifier. We selected the timezone 'UTC' for now, but please set date.timezone to select your timezone. in /usr/share/php/PhpDocumentor/phpDocumentor/Smarty-2.6.0/libs/Smarty_Compiler.class.php on line 370
<a name="functionawl_replace_sql_args" id="functionawl_replace_sql_args"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">awl_replace_sql_args</span> (line <span class="line-number">219</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Replaces PostgreSQL query with escaped parameters in preparation  for execution.</p>
<p class="description"><p>The function takes a variable number of arguments, the first is the  SQL string, with replaceable '?' characters (a la DBI).  The subsequent  parameters being the values to replace into the SQL string.</p><p>The values passed to the routine are analyzed for type, and quoted if  they appear to need quoting.  This can go wrong for (e.g.) NULL or  other special SQL values which are not straightforwardly identifiable  as needing quoting (or not).  In such cases the parameter can be forced  to be inserted unquoted by passing it as &quot;array( 'plain' =&gt; $param )&quot;.</p><p>This function is outside the PgQuery class because it is sometimes  desirable to build SQL command strings in circumstances where there  is no benefit to using the class.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> built query string</li>
			</ul>
	<div class="method-signature">
		<span class="method-result">The</span>
		<span class="method-name">
			awl_replace_sql_args
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">0</span>, <span class="var-type">mixed</span>&nbsp;<span class="var-name">1</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">0</span><span class="var-description">: The query string with replacable '?' characters.</span>			</li>
					<li>
				<span class="var-type">mixed</span>
				<span class="var-name">1</span><span class="var-description">: The values to replace into the SQL string.</span>			</li>
				</ul>
		
	
</div>
<a name="functionclean_string" id="functionclean_string"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">clean_string</span> (line <span class="line-number">182</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Clean a string of many suspicious characters</p>
<p class="description"><p>While this is a fairly aggressive approach, it applies in many circumstances  where various strings should not contain things that might screw up (e.g.)  filesystem semantics.  Although not strictly a PgQuery function it's here  for the time being until I invent a new &quot;generally useful functions&quot; include.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> The pristine uncontaminated string we can safely use for Just About Anything(tm).</li>
			</ul>
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			clean_string
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$unclean</span>, [<span class="var-type"></span>&nbsp;<span class="var-name">$type</span> = <span class="var-default">&#039;full&#039;</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$unclean</span><span class="var-description">: The dirty filthy string needing washing.</span>			</li>
					<li>
				<span class="var-type"></span>
				<span class="var-name">$type</span>			</li>
				</ul>
		
	
</div>
<a name="functionconnect_configured_database" id="functionconnect_configured_database"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">connect_configured_database</span> (line <span class="line-number">61</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Connect to the database defined in the $c-&gt;dbconn[] array</p>
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			connect_configured_database
		</span>
				()
			</div>

		
	
</div>
<a name="functionduration" id="functionduration"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">duration</span> (line <span class="line-number">121</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">A duration (in decimal seconds) between two times which are the result of calls to microtime()</p>
<p class="description"><p>This simple function is used by the PgQuery class because the  microtime function doesn't return a decimal time, so a simple  subtraction is not sufficient.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> difference</li>
			</ul>
	<div class="method-signature">
		<span class="method-result">double</span>
		<span class="method-name">
			duration
		</span>
					(<span class="var-type">microtime</span>&nbsp;<span class="var-name">$t1</span>, <span class="var-type">microtime</span>&nbsp;<span class="var-name">$t2</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">microtime</span>
				<span class="var-name">$t1</span><span class="var-description">: start time</span>			</li>
					<li>
				<span class="var-type">microtime</span>
				<span class="var-name">$t2</span><span class="var-description">: end time</span>			</li>
				</ul>
		
	
</div>
<a name="functionqpg" id="functionqpg"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">qpg</span> (line <span class="line-number">147</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Quote the given string (depending on its type) so that it can be used  safely in a PostgreSQL query without fear of SQL injection errors.</p>
<p class="description"><p>Although this function effectively achieves a similar goal to the pg_escape_string()  function, it is needed for older versions of PHP (&lt; 4.2.0) and older versions  of PostgreSQL (&lt; 7.2.0), however.  PgQuery does not attempt to use the newer  pg_escape_string() function at this stage.</p><p>This function is outside the PgQuery class because it is sometimes  desirable to quote values for SQL command strings in circumstances  where there is no benefit to using the class.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> NULL, TRUE, FALSE, a plain number, or the original string quoted and with ' and \ characters escaped</li>
			</ul>
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			qpg
		</span>
					([<span class="var-type">mixed</span>&nbsp;<span class="var-name">$str</span> = <span class="var-default">null</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">mixed</span>
				<span class="var-name">$str</span><span class="var-description">: Data to be converted to a string suitable for including as a value in SQL.</span>			</li>
				</ul>
		
	
</div>
		</div>
	</div>
	
	<p class="notes" id="credit">
		Documentation generated on Wed, 04 Jul 2012 07:06:15 +0000 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.4.3</a>
	</p>
	</div></body>
</html>